{% macro datatable(id, data) %}
{% set data_table = [data, 'data'] | table %}
<table id="table{{ id }}" class="govuk-body-s table-container" style="width: 100%;">
    {% for row in data_table %}
    <tr>
        {% for cell in row %}
        <td>{{ cell }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
</table>
<script>
    let tbl{{ id }} = false, dataTable{{ id }}
    window.document.addEventListener('DOMContentLoaded', function () {
        try {
            if (!tbl{{ id }}) dataTable{{ id }} = new DataTable('table{{ id }}', null, { 'dataFormat': 'array', 'allowColumnResize': true, 'allowFilter': true, 'allowSort': true, 'pageSize': 10, '_columns': ['Ind_code', 'Ind_name', 'Value', 'Unit'] })
            tbl{{ id }} = true
        }
        catch (e) {}
    })

    function downloadData{{ id }}() {
        if (dataTable{{ id }}) {
            dataTable{{ id }}.downloadData('csv')
        }
    }
</script>
{% endmacro %}
